<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Držitelé ceny Z.V. Tobolky - Tobolkometrie</title>
  <meta name="description" content="Kompletní databáze držitelů ceny Z.V. Tobolky od roku 1995">

  <link rel="stylesheet" href="styles.css">

  <script data-goatcounter="https://demoklion.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

  <style>
    /* Drzitele-specific styles */

    .header {
      background: var(--foreground);
      border-bottom: 4px solid var(--primary);
      color: var(--background);
      padding: 1rem 0;
      margin-bottom: 2rem;
    }

    .header-content {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header h1 {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--background);
    }

    .header a {
      color: var(--background);
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: var(--radius);
      transition: background 0.2s;
    }

    .header a:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1rem 3rem;
    }

    .page-title {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
    }

    .page-subtitle {
      font-size: 1.125rem;
      color: var(--muted-foreground);
      margin-bottom: 2rem;
    }

    .stats-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.5rem;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary);
    }

    .stat-label {
      font-size: 0.875rem;
      color: var(--muted-foreground);
      margin-top: 0.5rem;
    }

    .controls {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .controls-row {
      display: grid;
      grid-template-columns: 1fr auto auto;
      gap: 1rem;
      align-items: center;
    }

    @media (max-width: 768px) {
      .controls-row {
        grid-template-columns: 1fr;
      }
    }

    .search-box {
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-size: 1rem;
    }

    .search-box svg {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted-foreground);
      pointer-events: none;
    }

    .filter-select {
      padding: 0.75rem 1rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--background);
      font-size: 0.875rem;
      min-width: 150px;
    }

    .table-container {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
    }

    .table-wrapper {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: rgba(196, 30, 58, 0.05);
      border-bottom: 2px solid var(--border);
    }

    th {
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--foreground);
      cursor: pointer;
      user-select: none;
    }

    th:hover {
      background: rgba(196, 30, 58, 0.1);
    }

    th.sortable::after {
      content: " ⇅";
      opacity: 0.3;
    }

    th.sort-asc::after {
      content: " ↑";
      opacity: 1;
    }

    th.sort-desc::after {
      content: " ↓";
      opacity: 1;
    }

    td {
      padding: 1rem;
      border-bottom: 1px solid var(--border);
    }

    tbody tr:hover {
      background: rgba(196, 30, 58, 0.05);
    }

    .name-cell {
      font-weight: 500;
    }

    .year-badge {
      display: inline-block;
      background: var(--primary);
      color: var(--primary-foreground);
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 600;
    }

    .note-cell {
      color: var(--muted-foreground);
      font-size: 0.875rem;
      max-width: 400px;
    }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: var(--muted-foreground);
    }

    .pagination {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      border-top: 1px solid var(--border);
    }

    .pagination-info {
      font-size: 0.875rem;
      color: var(--muted-foreground);
    }

    .pagination-controls {
      display: flex;
      gap: 0.5rem;
    }

    .page-btn {
      padding: 0.5rem 1rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--background);
      cursor: pointer;
      font-size: 0.875rem;
    }

    .page-btn:hover:not(:disabled) {
      background: var(--primary);
      color: var(--primary-foreground);
      border-color: var(--primary);
    }

    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Footer styles inherited from styles.css */
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <h1 class="font-serif">Tobolkometrie</h1>
      <a href="index.html">← Hlavní stránka</a>
    </div>
  </header>

  <div class="container">
    <h1 class="page-title font-serif">Držitelé ceny Z.V. Tobolky</h1>
    <p class="page-subtitle">Kompletní databáze oceněných od roku 1995</p>

    <div class="stats-bar">
      <div class="stat-card">
        <div class="stat-value" id="totalCount">-</div>
        <div class="stat-label">Celkem oceněných</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="yearRange">-</div>
        <div class="stat-label">Roky udělení</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="filteredCount">-</div>
        <div class="stat-label">Zobrazeno</div>
      </div>
    </div>

    <div class="controls">
      <div class="controls-row">
        <div class="search-box">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
          <input type="text" id="searchInput" placeholder="Hledat podle jména, instituce nebo poznámky...">
        </div>
        <select id="yearFilter" class="filter-select">
          <option value="">Všechny roky</option>
        </select>
        <select id="perPage" class="filter-select">
          <option value="25">25 na stránku</option>
          <option value="50" selected>50 na stránku</option>
          <option value="100">100 na stránku</option>
          <option value="999999">Vše</option>
        </select>
      </div>
    </div>

    <div class="table-container">
      <div class="table-wrapper">
        <table id="recipientsTable">
          <thead>
            <tr>
              <th class="sortable" data-column="Rok">Rok</th>
              <th class="sortable" data-column="Příjmení">Příjmení</th>
              <th class="sortable" data-column="Jméno">Jméno</th>
              <th class="sortable" data-column="Instituce">Instituce</th>
              <th data-column="Poznámka">Poznámka</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr>
              <td colspan="5" class="empty-state">Načítání dat...</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="pagination">
        <div class="pagination-info" id="paginationInfo">-</div>
        <div class="pagination-controls">
          <button class="page-btn" id="prevPage">← Předchozí</button>
          <button class="page-btn" id="nextPage">Další →</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div style="max-width: 1200px; margin: 0 auto; padding: 0 1rem;">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: left; margin-bottom: 2rem;">
        <div>
          <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; color: var(--background);">Navigace</h3>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin-bottom: 0.5rem;">
              <a href="index.html" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                  <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                Hlavní stránka
              </a>
            </li>
            <li style="margin-bottom: 0.5rem;">
              <a href="drzitele.html" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                  <circle cx="9" cy="7" r="4"></circle>
                  <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                Držitelé ceny
              </a>
            </li>
            <li style="margin-bottom: 0.5rem;">
              <a href="clanky.html" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                Články
              </a>
            </li>
            <li style="margin-bottom: 0.5rem;">
              <a href="metodika.html" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <line x1="8" y1="6" x2="21" y2="6"></line>
                  <line x1="8" y1="12" x2="21" y2="12"></line>
                  <line x1="8" y1="18" x2="21" y2="18"></line>
                  <line x1="3" y1="6" x2="3.01" y2="6"></line>
                  <line x1="3" y1="12" x2="3.01" y2="12"></line>
                  <line x1="3" y1="18" x2="3.01" y2="18"></line>
                </svg>
                Metodika
              </a>
            </li>
            <li style="margin-bottom: 0.5rem;">
              <a href="admin/" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
                CMS Admin
              </a>
            </li>
          </ul>
        </div>

        <div>
          <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; color: var(--background);">O projektu</h3>
          <p style="line-height: 1.6; color: var(--background); opacity: 0.9; margin: 0;">
            Tobolkometrie je výzkumný projekt zaměřený na analýzu české knihovnické obce prostřednictvím držitelů ceny Z.V. Tobolky.
          </p>
        </div>

        <div>
          <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; color: var(--background);">Odkazy</h3>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin-bottom: 0.5rem;">
              <a href="https://github.com/demoklion/tobolkometrie" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path>
                  <path d="M9 18c-4.51 2-5-2-7-2"></path>
                </svg>
                GitHub
              </a>
            </li>
            <li style="margin-bottom: 0.5rem;">
              <a href="https://sdruk.cz/seznam-ocenenych/" target="_blank" rel="noopener" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                </svg>
                Seznam oceněných (SKIP ČR)
              </a>
            </li>
          </ul>
        </div>
      </div>

      <div style="border-top: 1px solid rgba(255, 255, 255, 0.2); padding-top: 2rem; text-align: center;">
        <p style="color: var(--background); opacity: 0.9; margin: 0;">
          © 2025 Tobolkometrie. Všechna práva vyhrazena.
        </p>
      </div>
    </div>

    <noscript><img src="https://demoklion.goatcounter.com/count?p=/drzitele" style="border: none; height: 1px; width: 1px;" alt=""></noscript>
  </footer>

  <script>
    let allData = [];
    let filteredData = [];
    let currentPage = 1;
    let itemsPerPage = 50;
    let sortColumn = 'Rok';
    let sortDirection = 'desc';

    // Easter egg: Jára Cimrman
    const cimrmanData = {
      "Příjmení": "Cimrman",
      "Jméno": "Jára",
      "Instituce": "Lijavecká lidová knihovna a čítárna",
      "Rok": 1896,
      "Poznámka": "za vynález desítkové soustavy třídění knih, konstrukci prvního knihobusu (tažený koněm) a průkopnickou práci v oblasti čtenářských průkazů (dřevěných). Posmrtně."
    };

    // Load data
    async function loadData() {
      try {
        const response = await fetch('tobolka_data.json');
        allData = await response.json();

        // Populate year filter
        const years = [...new Set(allData.map(r => r.Rok))].filter(y => y).sort((a, b) => b - a);
        const yearFilter = document.getElementById('yearFilter');
        years.forEach(year => {
          const option = document.createElement('option');
          option.value = year;
          option.textContent = year;
          yearFilter.appendChild(option);
        });

        // Update stats
        updateStats();
        filterAndSort();
      } catch (error) {
        console.error('Error loading data:', error);
        document.getElementById('tableBody').innerHTML =
          '<tr><td colspan="5" class="empty-state">Chyba při načítání dat</td></tr>';
      }
    }

    function updateStats() {
      document.getElementById('totalCount').textContent = allData.length;

      const years = allData.map(r => r.Rok).filter(y => y);
      const minYear = Math.min(...years);
      const maxYear = Math.max(...years);
      document.getElementById('yearRange').textContent = `${minYear}–${maxYear}`;
    }

    function filterAndSort() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const yearFilter = document.getElementById('yearFilter').value;

      // Easter egg: Check if searching for Cimrman
      const isCimrmanSearch = searchTerm.includes('cimrman') || searchTerm.includes('jára') ||
                              searchTerm.includes('jara') || searchTerm.includes('cimerman');

      // Filter
      filteredData = allData.filter(record => {
        const matchesSearch = !searchTerm ||
          (record.Příjmení && record.Příjmení.toLowerCase().includes(searchTerm)) ||
          (record.Jméno && record.Jméno.toLowerCase().includes(searchTerm)) ||
          (record.Instituce && record.Instituce.toLowerCase().includes(searchTerm)) ||
          (record.Poznámka && record.Poznámka.toLowerCase().includes(searchTerm));

        const matchesYear = !yearFilter || record.Rok == yearFilter;

        return matchesSearch && matchesYear;
      });

      // Add Cimrman if searching for him (and no year filter or matching 1896)
      if (isCimrmanSearch && (!yearFilter || yearFilter == '1896')) {
        filteredData.unshift(cimrmanData);
      }

      // Sort
      filteredData.sort((a, b) => {
        let aVal = a[sortColumn];
        let bVal = b[sortColumn];

        // Handle null values
        if (aVal === null || aVal === undefined) return 1;
        if (bVal === null || bVal === undefined) return -1;

        // Compare
        if (typeof aVal === 'number' && typeof bVal === 'number') {
          return sortDirection === 'asc' ? aVal - bVal : bVal - aVal;
        }

        aVal = String(aVal).toLowerCase();
        bVal = String(bVal).toLowerCase();

        if (sortDirection === 'asc') {
          return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
        } else {
          return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;
        }
      });

      document.getElementById('filteredCount').textContent = filteredData.length;
      currentPage = 1;
      renderTable();
    }

    function renderTable() {
      const tbody = document.getElementById('tableBody');
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageData = filteredData.slice(start, end);

      if (pageData.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="empty-state">Žádné záznamy</td></tr>';
        updatePagination();
        return;
      }

      tbody.innerHTML = pageData.map(record => {
        const isCimrman = record.Příjmení === 'Cimrman' && record.Jméno === 'Jára';
        return `
        <tr${isCimrman ? ' style="background: linear-gradient(90deg, rgba(255,215,0,0.1) 0%, rgba(255,215,0,0.05) 100%); font-style: italic;"' : ''}>
          <td><span class="year-badge"${isCimrman ? ' style="background: #d4af37; color: white;"' : ''}>${record.Rok || '-'}</span></td>
          <td class="name-cell">${record.Příjmení || '-'}${isCimrman ? ' ✨' : ''}</td>
          <td class="name-cell">${record.Jméno || '-'}</td>
          <td>${record.Instituce || '-'}</td>
          <td class="note-cell">${record.Poznámka || '-'}</td>
        </tr>
      `}).join('');

      updatePagination();
      updateSortIndicators();
    }

    function updatePagination() {
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      const start = (currentPage - 1) * itemsPerPage + 1;
      const end = Math.min(currentPage * itemsPerPage, filteredData.length);

      document.getElementById('paginationInfo').textContent =
        `Zobrazeno ${start}–${end} z ${filteredData.length}`;

      document.getElementById('prevPage').disabled = currentPage === 1;
      document.getElementById('nextPage').disabled = currentPage >= totalPages;
    }

    function updateSortIndicators() {
      document.querySelectorAll('th.sortable').forEach(th => {
        th.classList.remove('sort-asc', 'sort-desc');
        if (th.dataset.column === sortColumn) {
          th.classList.add(`sort-${sortDirection}`);
        }
      });
    }

    // Event listeners
    document.getElementById('searchInput').addEventListener('input', filterAndSort);
    document.getElementById('yearFilter').addEventListener('change', filterAndSort);
    document.getElementById('perPage').addEventListener('change', (e) => {
      itemsPerPage = parseInt(e.target.value);
      currentPage = 1;
      renderTable();
    });

    document.getElementById('prevPage').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderTable();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    document.getElementById('nextPage').addEventListener('click', () => {
      const totalPages = Math.ceil(filteredData.length / itemsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        renderTable();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    // Column sorting
    document.querySelectorAll('th.sortable').forEach(th => {
      th.addEventListener('click', () => {
        const column = th.dataset.column;
        if (sortColumn === column) {
          sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
        } else {
          sortColumn = column;
          sortDirection = 'asc';
        }
        filterAndSort();
      });
    });

    // Load data on page load
    loadData();
  </script>
</body>
</html>
